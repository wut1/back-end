webpackJsonp([4],{F3gi:function(t,n,l){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e=l("WT6e"),i=function(){},o=l("7DMc"),s=l("Xjw4"),u=function(){function t(t){this._opts={immediateAngularModelUpdate:!1,angularIgnoreAttrs:null},this.SPECIAL_TAGS=["img","button","input","a"],this.INNER_HTML_ATTR="innerHTML",this._hasSpecialTag=!1,this._listeningEvents=[],this._editorInitialized=!1,this._oldModel=null,this.onChange=function(t){},this.onTouched=function(){},this.froalaModelChange=new e.m,this.froalaInit=new e.m;var n=t.nativeElement;-1!=this.SPECIAL_TAGS.indexOf(n.tagName.toLowerCase())&&(this._hasSpecialTag=!0),this._$element=$(n)}return t.prototype.writeValue=function(t){this.updateEditor(t)},t.prototype.registerOnChange=function(t){this.onChange=t},t.prototype.registerOnTouched=function(t){this.onTouched=t},Object.defineProperty(t.prototype,"froalaEditor",{set:function(t){this._opts=t||this._opts},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"froalaModel",{set:function(t){this.updateEditor(t)},enumerable:!0,configurable:!0}),t.prototype.updateEditor=function(t){JSON.stringify(this._oldModel)!=JSON.stringify(t)&&(this._model=t,this._editorInitialized&&this.setContent())},t.prototype.updateModel=function(){var t=null;if(this._hasSpecialTag){for(var n=this._$element[0].attributes,l={},e=0;e<n.length;e++){var i=n[e].name;this._opts.angularIgnoreAttrs&&-1!=this._opts.angularIgnoreAttrs.indexOf(i)||(l[i]=n[e].value)}this._$element[0].innerHTML&&(l[this.INNER_HTML_ATTR]=this._$element[0].innerHTML),t=l}else{var o=this._$element.froalaEditor("html.get");"string"==typeof o&&(t=o)}this._oldModel=t,this.froalaModelChange.emit(t),this.onChange(t)},t.prototype.registerEvent=function(t,n,l){t&&n&&l&&(this._listeningEvents.push(n),t.on(n,l))},t.prototype.initListeners=function(){var t=this;this.registerEvent(this._$element,"froalaEditor.contentChanged",function(){setTimeout(function(){t.updateModel()},0)}),this._opts.immediateAngularModelUpdate&&this.registerEvent(this._editor,"keyup",function(){setTimeout(function(){t.updateModel()},0)})},t.prototype.registerFroalaEvents=function(){if(this._opts.events)for(var t in this._opts.events)this._opts.events.hasOwnProperty(t)&&this.registerEvent(this._$element,t,this._opts.events[t])},t.prototype.createEditor=function(){this._editorInitialized||(this.setContent(!0),this.registerFroalaEvents(),this._editor=this._$element.froalaEditor(this._opts).data("froala.editor").$el,this.initListeners(),this._editorInitialized=!0)},t.prototype.setHtml=function(){this._$element.froalaEditor("html.set",this._model||"",!0),this._$element.froalaEditor("undo.reset"),this._$element.froalaEditor("undo.saveStep")},t.prototype.setContent=function(t){void 0===t&&(t=!1);var n=this;if(this._model||""==this._model)if(this._oldModel=this._model,this._hasSpecialTag){var l=this._model;if(l){for(var e in l)l.hasOwnProperty(e)&&e!=this.INNER_HTML_ATTR&&this._$element.attr(e,l[e]);l.hasOwnProperty(this.INNER_HTML_ATTR)&&(this._$element[0].innerHTML=l[this.INNER_HTML_ATTR])}}else t?this.registerEvent(this._$element,"froalaEditor.initialized",function(){n.setHtml()}):n.setHtml()},t.prototype.destroyEditor=function(){this._editorInitialized&&(this._$element.off(this._listeningEvents.join(" ")),this._editor.off("keyup"),this._$element.froalaEditor("destroy"),this._listeningEvents.length=0,this._editorInitialized=!1)},t.prototype.getEditor=function(){return this._$element?this._$element.froalaEditor.bind(this._$element):null},t.prototype.generateManualController=function(){var t={initialize:this.createEditor.bind(this),destroy:this.destroyEditor.bind(this),getEditor:this.getEditor.bind(this)};this.froalaInit.emit(t)},t.prototype.ngOnInit=function(){this.froalaInit.observers.length?this.generateManualController():this.createEditor()},t.prototype.ngOnDestroy=function(){this.destroyEditor()},t}(),r=l("ItHS"),a=function(){function t(t){this.http=t}return t.prototype.postPublish=function(t){return this.http.post(CONFIGNI.publish,t)},t}(),h=l("QpOp"),d=l("bfOx"),_=function(){function t(t,n,l){var e=this;this.fb=t,this.publishService=n,this.router=l,this.submitted=!1,this.options={placeholderText:"\u5728\u8fd9\u91cc\u7f16\u8f91!",language:"zh_cn",imageUploadURL:h.a.realHost+CONFIGNI.upload,imageErrorCallback:function(t){console.log(t)},events:{"froalaEditor.focus":function(t,n){var l=n.html.get();e.setControlValue(l)},"froalaEditor.contentChanged":function(t,n){var l=n.html.get();e.setControlValue(l)}}},this.form=t.group({title:["",o.o.compose([o.o.required])],editor:["",o.o.compose([o.o.required])]}),this.title=this.form.controls.title,this.editor=this.form.controls.editor}return t.prototype.onSubmit=function(t){var n=this;this.submitted=!0,this.form.valid&&this.publishService.postPublish(t).subscribe(function(t){1==t.resultCode&&(alert("\u53d1\u5e03\u6210\u529f"),n.router.navigate(["/page/home"]))})},t.prototype.setControlValue=function(t){this.form.patchValue({editor:t})},t}(),p=e._1({encapsulation:0,styles:[[".publish-ui[_ngcontent-%COMP%]{position:absolute;top:60px;right:0;left:0;bottom:0;z-index:2}.publish-ui[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{height:40px}.publish-ui[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:40px;border:0;padding:0 12px}.publish-ui[_ngcontent-%COMP%]   .has-error[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border:1px solid #fa758e}.publish-ui[_ngcontent-%COMP%]   .editor-layout[_ngcontent-%COMP%]{position:absolute;z-index:9;top:40px;bottom:40px;left:0;right:0;overflow-y:auto}.publish-ui[_ngcontent-%COMP%]   .publish-btn[_ngcontent-%COMP%]{position:absolute;left:0;height:40px;vertical-align:middle;width:100%;bottom:0;text-align:center}"]],data:{}});function c(t){return e._25(0,[(t()(),e._3(0,0,null,null,35,"div",[["class","publish-ui"]],null,null,null,null,null)),(t()(),e._23(-1,null,["\n    "])),(t()(),e._3(2,0,null,null,32,"form",[["novalidate",""]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngSubmit"],[null,"submit"],[null,"reset"]],function(t,n,l){var i=!0,o=t.component;return"submit"===n&&(i=!1!==e._14(t,4).onSubmit(l)&&i),"reset"===n&&(i=!1!==e._14(t,4).onReset()&&i),"ngSubmit"===n&&(i=!1!==o.onSubmit(o.form.value)&&i),i},null,null)),e._2(3,16384,null,0,o.q,[],null,null),e._2(4,540672,null,0,o.g,[[8,null],[8,null]],{form:[0,"form"]},{ngSubmit:"ngSubmit"}),e._19(2048,null,o.b,null,[o.g]),e._2(6,16384,null,0,o.m,[o.b],null,null),(t()(),e._23(-1,null,["\n        "])),(t()(),e._3(8,0,null,null,10,"div",[["class","title"]],null,null,null,null,null)),e._2(9,278528,null,0,s.h,[e.q,e.r,e.k,e.B],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e._17(10,{"has-error":0,"has-success":1}),(t()(),e._23(-1,null,["\n            "])),(t()(),e._3(12,0,null,null,5,"input",[["class","form-control"],["placeholder","\u6807\u9898"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(t,n,l){var i=!0;return"input"===n&&(i=!1!==e._14(t,13)._handleInput(l.target.value)&&i),"blur"===n&&(i=!1!==e._14(t,13).onTouched()&&i),"compositionstart"===n&&(i=!1!==e._14(t,13)._compositionStart()&&i),"compositionend"===n&&(i=!1!==e._14(t,13)._compositionEnd(l.target.value)&&i),i},null,null)),e._2(13,16384,null,0,o.c,[e.B,e.k,[2,o.a]],null,null),e._19(1024,null,o.j,function(t){return[t]},[o.c]),e._2(15,540672,null,0,o.e,[[8,null],[8,null],[2,o.j]],{form:[0,"form"]},null),e._19(2048,null,o.k,null,[o.e]),e._2(17,16384,null,0,o.l,[o.k],null,null),(t()(),e._23(-1,null,["\n        "])),(t()(),e._23(-1,null,["\n        "])),(t()(),e._3(20,0,null,null,7,"div",[["class","editor-layout"]],null,null,null,null,null)),e._2(21,278528,null,0,s.h,[e.q,e.r,e.k,e.B],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),e._17(22,{"has-error":0}),(t()(),e._23(-1,null,["\n            "])),(t()(),e._3(24,0,null,null,2,"div",[],null,null,null,null,null)),e._19(5120,null,o.j,function(t){return[t]},[u]),e._2(26,212992,null,0,u,[e.k],{froalaEditor:[0,"froalaEditor"]},null),(t()(),e._23(-1,null,["\n        "])),(t()(),e._23(-1,null,["\n        "])),(t()(),e._3(29,0,null,null,4,"div",[["class","publish-btn"]],null,null,null,null,null)),(t()(),e._23(-1,null,["\n            "])),(t()(),e._3(31,0,null,null,1,"button",[["class","btn btn-primary"],["type","submit"]],[[8,"disabled",0]],null,null,null,null)),(t()(),e._23(-1,null,["\u53d1\u5e03"])),(t()(),e._23(-1,null,["\n        "])),(t()(),e._23(-1,null,["\n    "])),(t()(),e._23(-1,null,["\n"]))],function(t,n){var l=n.component;t(n,4,0,l.form),t(n,9,0,"title",t(n,10,0,!l.title.valid&&l.title.touched,l.title.valid&&l.title.touched)),t(n,15,0,l.title),t(n,21,0,"editor-layout",t(n,22,0,!l.editor.valid)),t(n,26,0,l.options)},function(t,n){var l=n.component;t(n,2,0,e._14(n,6).ngClassUntouched,e._14(n,6).ngClassTouched,e._14(n,6).ngClassPristine,e._14(n,6).ngClassDirty,e._14(n,6).ngClassValid,e._14(n,6).ngClassInvalid,e._14(n,6).ngClassPending),t(n,12,0,e._14(n,17).ngClassUntouched,e._14(n,17).ngClassTouched,e._14(n,17).ngClassPristine,e._14(n,17).ngClassDirty,e._14(n,17).ngClassValid,e._14(n,17).ngClassInvalid,e._14(n,17).ngClassPending),t(n,31,0,!l.form.valid)})}var g=e.Z("publish",_,function(t){return e._25(0,[(t()(),e._3(0,0,null,null,1,"publish",[],null,null,null,c,p)),e._2(1,49152,null,0,_,[o.d,a,d.l],null,null)],null,null)},{},{},[]),f=function(){function t(){}return t.forRoot=function(){return{ngModule:t,providers:[]}},t}(),m=function(){function t(){}return t.forRoot=function(){return{ngModule:t,providers:[]}},t}();l.d(n,"PublishModuleNgFactory",function(){return v});var v=e._0(i,[],function(t){return e._11([e._12(512,e.j,e.W,[[8,[g]],[3,e.j],e.v]),e._12(4608,s.l,s.k,[e.s,[2,s.p]]),e._12(4608,o.d,o.d,[]),e._12(4608,o.r,o.r,[]),e._12(4608,a,a,[r.c]),e._12(512,s.b,s.b,[]),e._12(512,o.p,o.p,[]),e._12(512,o.n,o.n,[]),e._12(512,d.n,d.n,[[2,d.s],[2,d.l]]),e._12(512,f,f,[]),e._12(512,m,m,[]),e._12(512,i,i,[]),e._12(1024,d.j,function(){return[[{path:"",component:_}]]},[])])})}});